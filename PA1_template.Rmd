---
title: "Reproducible Research: Peer Assessment 1"
author: "Panagiotis Cheilaris"
date: "2015-03-03"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
zipfile = "activity.zip"
unzip(zipfile)
activity <- read.csv("activity.csv", header = TRUE)
```


## What is the mean total number of steps taken per day?

1. We use library dplyr to manipulate the data
and calculate the total number of steps taken per day.
```{r message=FALSE}
library(dplyr)
totperday <- activity %>% group_by(date) %>% summarize(tot=sum(steps))
```

2. Here is the histogram:
```{r}
hist(totperday$tot, main="Histogram of total number of steps per day",
     xlab="Total number of steps", labels=TRUE, ylim=c(0,40))
```

3. Here are the mean and median computations:
```{r}
meantotday <- mean(totperday$tot, na.rm=TRUE)
mediantotday <- median(totperday$tot, na.rm=TRUE)
options(scipen=100)
```

For the **total number of steps per day**,
the **mean** is `r meantotday` and the **median** is `r mediantotday`.

## What is the average daily activity pattern?

1. Here is the plot:
```{r}
meanperint <- activity %>% group_by(interval) %>% summarize(intmean=mean(steps, na.rm=TRUE))
plot(meanperint, type = "l", ylab = "average number of steps per interval")
```

2. The 5-minute interval with the maximum average number of steps is:
```{r}
meanperint[which.max(meanperint$intmean),]$interval
```

## Inputing missing values

1. The total number of missing values in the dataset is:
```{r}
sum(is.na(activity$steps))
```

2. We will substitute each missing NA steps value with the average value
for the 5-minute interval from the previous part.

```{r}
fixstep <- function(inter, step) { if (is.na(step)) meanperint[which(meanperint$interval == inter),]$intmean else step }
```

3. Here is the new dataset with the new column stepsfixed.
```{r}
activitywithoutna <- activity %>% transform( stepsfixed = mapply(fixstep, interval, steps) )
```

4. Here is the new histogram:
```{r}
totnewperday <- activitywithoutna %>% group_by(date) %>% summarize(tot=sum(stepsfixed))
hist(totnewperday$tot, main="Histogram of total number of steps per day (without NA)",
     xlab="Total number of steps (without NA)", labels=TRUE, ylim=c(0,40))
```

And here are the mean and median without NA:
```{r}
meantotnewday <- mean(totnewperday$tot, na.rm=TRUE)
mediantotnewday <- median(totnewperday$tot, na.rm=TRUE)
```
For the **total number of steps per day without NA**,
the **mean** is `r meantotnewday` and the **median** is `r mediantotnewday`.

The two mean values are the same (`r meantotnewday`) and the new median value
is the same as the mean values. This happens because the NA values are in eight
days and these eight days have no non-NA value at all. As a result, the updated
mean for each of these eight days becomes `r meantotnewday` (compare the two
histograms to see that the only difference is the middle rectangle with frequency
28 and 36) and the new mean for all days remains the same as the previously
computed mean. Moreover, the new median value is expected since there are eight
copies of `r meantotnewday` in the data.

## Are there differences in activity patterns between weekdays and weekends?
