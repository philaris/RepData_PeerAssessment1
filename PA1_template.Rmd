---
title: "Reproducible Research: Peer Assessment 1"
author: "Panagiotis Cheilaris"
date: "2015-03-03"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
zipfile = "activity.zip"
unzip(zipfile)
activity <- read.csv("activity.csv", header = TRUE)
```


## What is the mean total number of steps taken per day?

1. We use library dplyr to manipulate the data
and calculate the total number of steps taken per day.
```{r message=FALSE}
library(dplyr)
totperday <- activity %>% group_by(date) %>% summarize(tot=sum(steps))
```

2. Here is the histogram:
```{r}
hist(totperday$tot, main="Histogram of total number of steps per day",
     xlab="Total number of steps")
```

3. Here are the mean and median computations:
```{r}
meantotday <- mean(totperday$tot, na.rm=TRUE)
mediantotday <- median(totperday$tot, na.rm=TRUE)
options(scipen=100)
```

For the **total number of steps per day**,
the **mean** is `r signif(meantotday, 7)` and the **median** is `r mediantotday`.

## What is the average daily activity pattern?

1. Here is the plot:
```{r}
meanperint <- activity %>% group_by(interval) %>% summarize(intmean=mean(steps, na.rm=TRUE))
plot(meanperint, type = "l", ylab = "average number of steps per interval")
```

2. The 5-minute interval with the maximum average number of steps is:
```{r}
meanperint[which.max(meanperint$intmean),]$interval
```

## Inputing missing values

1. The total number of missing values in the dataset is:
```{r}
sum(is.na(activity$steps))
```

2. We substitute each missing NA steps value with the average value
for the 5-minute interval from the previous part.

```{r}
fixstep <- function(inter, step) { if (is.na(step)) meanperint[which(meanperint$interval == inter),]$intmean else step }
activitywithoutna <- activity %>% transform( stepsnew = mapply(fixstep, interval, steps) )
```

## Are there differences in activity patterns between weekdays and weekends?
